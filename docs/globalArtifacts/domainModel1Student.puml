@startuml domainModel

'=======================
' AGGREGATES
'=======================
 package "Dock Aggregate" {
  ' Value Objects
  class DockName <<value object>> {
    -value: string
  }
  
  class DockLength <<value object>> {
    -value: double
  }
  
  class Depth <<value object>> {
    -value: double
  }
  
  class Draft <<value object>> {
    -value: double
  }
  
  class Location <<value object>> {
    -coordinates: string
    -description: string
  }
  
  ' Entities
  class Dock <<aggregate root>> {
    -dockId: Guid
    -allowedVesselTypeIds: List<Guid>
  }
 }

' --- STORAGE AREA AGGREGATE ---
package "StorageArea Aggregate" {
  ' Value Objects
  class StorageAreaName <<value object>> {
    -value: string
  }
  
  class StorageAreaType <<enumeration>> {
    YARD
    WAREHOUSE
  }
  
  class MaxCapacityTeu <<value object>> {
    -value: int
  }
  
  class CurrentOccupancy <<value object>> {
    -value: int
  }
  
  class StorageLocation <<value object>> {
    -value: string
  }
  
  class Distance <<value object>> {
    -value: double
    -unit: string
  }
  
  ' Entities
  class StorageArea <<aggregate root>> {
    -storageAreaId: Guid
    -containerIsoCodes: List<string>
    -servesDocks: List<Guid>
    -distanceToDocks: Dictionary<Guid, Distance>
  }
 }

 ' --- VESSEL TYPE AGGREGATE ---
package "VesselType Aggregate" {
  ' Value Objects
  class TypeName <<value object>> {
    -value: string
  }
  
  class TypeDescription <<value object>> {
    -value: string
  }
  
  class MaxCapacity <<value object>> {
    -value: int
  }
  
  class MaxRows <<value object>> {
    -value: int
  }
  
  class MaxBays <<value object>> {
    -value: int
  }
  
  class MaxTiers <<value object>> {
    -value: int
  }
  
  ' Entities
  class VesselType <<aggregate root>> {
    -vesselTypeId: Guid
  }
}

' --- VESSEL AGGREGATE ---
package "Vessel Aggregate" {
  ' Value Objects
  class IMO <<id>> {
    -number: string
  }
  
  class VesselLength <<value object>> {
    -value: double
  }
  
  class Capacity <<value object>> {
    -value: int
  }
  
  class VesselName <<value object>> {
    -name: string
  }
  
  class Teu <<value object>> {
    -value: int
  }
  
  ' Entities
  class Vessel <<aggregate root>> {
    -vesselTypeId: Guid
  }
}

' --- VESSEL VISIT NOTIFICATION AGGREGATE ---
package "VesselVisitNotification Aggregate" {
  ' Value Objects
  class ExpectedTimeOfArrival <<value object>> {
    -dateTime: DateTime
  }
  
  class ExpectedTimeOfDeparture <<value object>> {
    -dateTime: DateTime
  }
  
  class isHazardousFlag <<value object>> {
    -value: bool
  }
  
  class visitStatus <<enumeration>> {
    PENDING
    ACCEPTED
    REJECTED
    IN_PROGRESS
  }
  
  class RejectionReason <<value object>> {
    -reason: string
  }
  
  ' Entities
  class VesselVisitNotification <<aggregate root>> {
    -visitId: Guid
    -assignedVesselImo: string
    -assignedDockId: Guid
  }
}

' --- CARGO MANIFEST AGGREGATE ---
package "CargoManifest Aggregate" {
  ' Value Objects
  class ManifestType <<enumeration>> {
    LOADING
    UNLOADING
  }
  
  class VesselPosition <<value object>> {
    -bay: int
    -row: int
    -tier: int
  }
  
  ' Entities
  class CargoManifest <<aggregate root>> {
    -manifestId: Guid
    -visitNotificationId: Guid
  }

  class ManifestEntry <<entity>> {
    -entryId: Guid
    -containerIsoCode: string
    -storageAreaId: Guid
  }
}

' --- CONTAINER AGGREGATE ---
package "Container Aggregate" {
  ' Value Objects
  class IsoCode <<id>> {
    -value: string
  }
  
  class SizeTeu <<value object>> {
    -value: int
  }
  
  class Hazmat <<value object>> {
    -isHazardous: bool
  }
  
  class CargoType <<value object>> {
    -type: string
  }
  
  class ContainerDescription <<value object>> {
    -text: string
  }
  
  ' Entities
  class Container <<aggregate root>> {
    -currentStorageAreaId: Guid
  }
}

'=======================
' RELATIONSHIPS & CARDINALITIES
'=======================

Dock "1" *-- "1" DockName
Dock "1" *-- "1" DockLength
Dock "1" *-- "1" Depth
Dock "1" *-- "1" Draft
Dock "1" *-- "1" Location

' STORAGE AREA AGGREGATE
StorageArea "1" *-- "1" StorageAreaName
StorageArea "1" *-- "1" StorageAreaType
StorageArea "1" *-- "1" MaxCapacityTeu
StorageArea "1" *-- "1" CurrentOccupancy
StorageArea "1" *-- "1" StorageLocation
StorageArea "1" *-- "0..*" Distance : distance to docks >

' VESSEL TYPE AGGREGATE
VesselType "1" *-- "1" TypeName
VesselType "1" *-- "1" TypeDescription
VesselType "1" *-- "1" MaxCapacity
VesselType "1" *-- "1" MaxRows
VesselType "1" *-- "1" MaxBays
VesselType "1" *-- "1" MaxTiers

' VESSEL AGGREGATE
' Vessel Aggregate - Value Object Relationships
Vessel "1" *-- "1" IMO
Vessel "1" *-- "1" VesselName
Vessel "1" *-- "1" Teu
Vessel "1" *-- "1" VesselLength
Vessel "1" *-- "1" Capacity
Vessel "1" --> "1" VesselType : classified by (by ID) >

' VESSEL VISIT NOTIFICATION AGGREGATE
VesselVisitNotification "1" --> "1" Vessel : refers to (by ID) >
VesselVisitNotification "1" --> "0..2" CargoManifest : references (by ID) >
VesselVisitNotification "1" --> "0..1" Dock : assigned to (by ID) >

' CARGO MANIFEST AGGREGATE
CargoManifest "1" *-- "1" ManifestType
CargoManifest "1" *-- "0..*" ManifestEntry : contains >
CargoManifest "1" --> "1" VesselVisitNotification : belongs to (by ID) >
ManifestEntry "1" *-- "1" VesselPosition
ManifestEntry "1" --> "1" Container : refers to (by ISO Code) >
ManifestEntry "1" --> "1" StorageArea : refers to (by ID) >

' CONTAINER AGGREGATE
Container "1" *-- "1" IsoCode
Container "1" *-- "1" SizeTeu
Container "1" *-- "1" Hazmat
Container "1" *-- "1" CargoType
Container "1" *-- "1" ContainerDescription
StorageArea "1" --> "0..*" Container : contains (by ISO Code) >

' VesselVisitNotification Aggregate - Value Object Relationships
VesselVisitNotification "1" *-- "1" ExpectedTimeOfArrival
VesselVisitNotification "1" *-- "1" ExpectedTimeOfDeparture
VesselVisitNotification "1" *-- "1" isHazardousFlag
VesselVisitNotification "1" *-- "1" visitStatus
VesselVisitNotification "1" *-- "0..1" RejectionReason

' --- USER AGGREGATE ---
package "User Aggregate" {
  ' Value Objects
  class Username <<value object>> {
    -value: string
  }
  
  class Email <<value object>> {
    -value: string
  }
  
  class UserRole <<enumeration>> {
    LOGISTICS_OPERATOR
    PORT_OPERATOR
    SHIP_AGENT
    CUSTOMS_OFFICER
    ADMIN
  }
  
  ' Entities
  class User <<aggregate root>> {
    -userId: Guid
    -roles: List<UserRole>
    -isActive: bool
  }
}

' --- OPERATION PLAN AGGREGATE ---
package "OperationPlan Aggregate" {
  ' Value Objects
  class PlanDate <<value object>> {
    -date: Date
  }
  
  class AlgorithmUsed <<value object>> {
    -name: string
  }
  
  class PlanStatus <<enumeration>> {
    DRAFT
    ACTIVE
    COMPLETED
  }
  
  class IsFeasible <<value object>> {
    -value: bool
  }
  
  ' Entities
  class OperationPlan <<aggregate root>> {
    -planId: Guid
    -createdBy: Guid
  }
  
  class VesselAssignment <<entity>> {
    -assignmentId: Guid
    -vvnId: Guid
    -dockId: Guid
    -eta: DateTime
    -etd: DateTime
  }
}

' --- VESSEL VISIT EXECUTION AGGREGATE ---
package "VesselVisitExecution Aggregate" {
  ' Value Objects
  class PlannedArrivalTime <<value object>> {
    -dateTime: DateTime
  }
  
  class PlannedDepartureTime <<value object>> {
    -dateTime: DateTime
  }
  
  class ActualArrivalTime <<value object>> {
    -dateTime: DateTime
  }
  
  class ActualDepartureTime <<value object>> {
    -dateTime: DateTime
  }
  
  class ExecutionStatus <<enumeration>> {
    NOT_STARTED
    IN_PROGRESS
    DELAYED
    COMPLETED
  }
  
  ' Entities
  class VesselVisitExecution <<aggregate root>> {
    -vveId: Guid
    -vvnId: Guid
    -operationPlanId: Guid
    -plannedDockId: Guid
    -actualDockId: Guid
    -vveDate: Date
  }
}

' --- INCIDENT TYPE AGGREGATE ---
package "IncidentType Aggregate" {
  ' Value Objects
  class IncidentCode <<value object>> {
    -value: string
  }
  
  class IncidentTypeName <<value object>> {
    -value: string
  }
  
  class Severity <<enumeration>> {
    MINOR
    MAJOR
    CRITICAL
  }
  
  ' Entities
  class IncidentType <<aggregate root>> {
    -incidentTypeId: Guid
  }
}

' --- INCIDENT AGGREGATE ---
package "Incident Aggregate" {
  ' Value Objects
  class IncidentDate <<value object>> {
    -date: Date
  }
  
  class StartTime <<value object>> {
    -dateTime: DateTime
  }
  
  class EndTime <<value object>> {
    -dateTime: DateTime
  }
  
  class IncidentDescription <<value object>> {
    -text: string
  }
  
  class AffectsAllVVEs <<value object>> {
    -value: bool
  }
  
  ' Entities
  class Incident <<aggregate root>> {
    -incidentId: Guid
    -incidentTypeId: Guid
    -affectedVVEIds: List<Guid>
    -isActive: bool
  }
}


' USER AGGREGATE RELATIONSHIPS
User "1" *-- "1" Username
User "1" *-- "1" Email
User "1" *-- "1..*" UserRole

' OPERATION PLAN AGGREGATE RELATIONSHIPS
OperationPlan "1" *-- "1" PlanDate
OperationPlan "1" *-- "1" AlgorithmUsed
OperationPlan "1" *-- "1" PlanStatus
OperationPlan "1" *-- "1" IsFeasible
OperationPlan "1" *-- "0..*" VesselAssignment : contains >
OperationPlan "1" --> "1" User : created by (by ID) >
VesselAssignment "1" --> "1" VesselVisitNotification : refers to (by ID) >
VesselAssignment "1" --> "1" Dock : assigns to (by ID) >

' VESSEL VISIT EXECUTION AGGREGATE RELATIONSHIPS
VesselVisitExecution "1" *-- "1" PlannedArrivalTime
VesselVisitExecution "1" *-- "1" PlannedDepartureTime
VesselVisitExecution "1" *-- "0..1" ActualArrivalTime
VesselVisitExecution "1" *-- "0..1" ActualDepartureTime
VesselVisitExecution "1" *-- "1" ExecutionStatus
VesselVisitExecution "1" --> "1" VesselVisitNotification : executes (by ID) >
VesselVisitExecution "1" --> "1" OperationPlan : belongs to (by ID) >
VesselVisitExecution "1" --> "1" Dock : planned at (by ID) >
VesselVisitExecution "1" --> "0..1" Dock : actual at (by ID) >

' INCIDENT TYPE AGGREGATE RELATIONSHIPS
IncidentType "1" *-- "1" IncidentCode
IncidentType "1" *-- "1" IncidentTypeName
IncidentType "1" *-- "1" Severity

' INCIDENT AGGREGATE RELATIONSHIPS
Incident "1" *-- "1" IncidentDate
Incident "1" *-- "1" StartTime
Incident "1" *-- "0..1" EndTime
Incident "1" *-- "1" IncidentDescription
Incident "1" *-- "1" AffectsAllVVEs
Incident "1" --> "1" IncidentType : classified by (by ID) >
Incident "1" --> "0..*" VesselVisitExecution : affects (by ID) >
@enduml
