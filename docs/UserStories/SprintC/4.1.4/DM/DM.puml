@startuml US_4.1.4_Domain_Model

!define AGGREGATE_ROOT_COLOR #FFDDAA
!define VALUE_OBJECT_COLOR #E8F5E9

class OperationPlan <<Aggregate Root>> AGGREGATE_ROOT_COLOR {
    - OperationPlanId id
    - DateTime planDate
    - AlgorithmUsed algorithmUsed
    - List<PlannedOperation> operations
    - PlanStatus status
    - UpdateReason? lastUpdateReason
    - DateTime? lastUpdatedAt
    + UpdatePlan(updates, reason)
    + ValidateUpdate() : ValidationResult
}

class OperationPlanId <<Value Object>> VALUE_OBJECT_COLOR {
    - string value
    + OperationPlanId(value)
}

class PlannedOperation <<Value Object>> VALUE_OBJECT_COLOR {
    - VvnId vvnId
    - OperationType type
    - DateTime startTime
    - DateTime endTime
    - List<ResourceId> resources
}

class PlanStatus <<Value Object>> VALUE_OBJECT_COLOR {
    - string value
    + PlanStatus(value)
}

class UpdateReason <<Value Object>> VALUE_OBJECT_COLOR {
    - string value
    + UpdateReason(value)
}

class ValidationResult <<Value Object>> VALUE_OBJECT_COLOR {
    - bool isValid
    - List<ValidationWarning> warnings
}

OperationPlan "1" *-- "1" OperationPlanId : id
OperationPlan "1" *-- "*" PlannedOperation : operations
OperationPlan "1" *-- "1" PlanStatus : status
OperationPlan "1" *-- "0..1" UpdateReason : lastUpdateReason

note right of OperationPlan
  Updates validated for:
  - Timing conflicts
  - Resource availability
  - Operational feasibility
end note

@enduml
